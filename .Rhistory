source('~/.active-rstudio-document', echo=TRUE)
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
?commandArgs
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
source('~/Occupy/NegativeBinomial.R', echo=TRUE)
pars<-extract_par(sim_detect,data=obs.state)
pars$Model<-"Occupancy"
filename<-paste("Dispersion/Allpars",dispersion,".csv",sep="")
write.csv(pars,filename)
#true number of observed interactions
true_state<-obs.state %>% group_by(Bird,Plant) %>% summarize(n=sum(Yobs)) %>% acast(.$Bird~.$Plant)
Ndetect<-pars[pars$par %in% "ynew",]
bydraw<-split(Ndetect,list(Ndetect$Chain,Ndetect$Draw))
occ_matrix<-lapply(bydraw,function(x){
r<-acast(x,species ~ plant,value.var = "estimate",fun.aggregate = sum)
})
#calculate discrep for those aggregated matrices
occ<-lapply(occ_matrix,function(r){
#for each position what is the chisq
rmerge<-matrix(nrow = nrow(true_state),ncol=ncol(true_state))
for (x in 1:nrow(r)){
for (y in 1:ncol(r)){
rmerge[x,y]<-chisq(e=r[x,y],o=true_state[x,y])
}
}
return(rmerge)
})
names(occ)<-1:length(occ)
names(occ_matrix)<-1:length(occ_matrix)
##Deviates
mmat<-melt(true_state)
colnames(mmat)<-c("Bird","Plant","True_State")
#append to predicted matrices
#occupancy with detection
mocc<-melt(occ_matrix)
colnames(mocc)<-c("Bird","Plant","Occupancy","Iteration")
simdat<-merge(mocc,mmat,by=c("Bird","Plant"),all.x=T)
filename<-paste("Dispersion/simdat",dispersion,".csv",sep="")
head(simdat)
detection
?set.seed
detection
detection= runif(h_species,0,0.5)
detection
setwd("C:\Users\Ben\Downloads\ecy1404-sup-0007-Supinfo2\MSOM_SuppMaterial")
setwd("C:\\Users\\Ben\\Downloads\\ecy1404-sup-0007-Supinfo2\\MSOM_SuppMaterial")
